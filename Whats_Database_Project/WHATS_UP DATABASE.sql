CREATE DATABASE WHATS_UP;

USE WHATS_UP;

CREATE TABLE USER1
(
	USER1_ID INT PRIMARY KEY,
	NAME VARCHAR(30) ,
	PHONE_NO BIGINT,
	CONTACT_ID VARCHAR(30),
	CHAT_ID VARCHAR(30),
	PROFILE_ID VARCHAR(30),
	STATUS_ID VARCHAR(30),
	BLOCK_ID VARCHAR(30),
	BROADCAST_ID VARCHAR(30)
);

SELECT * FROM USER1;

INSERT INTO USER1 VALUES(1,'SAI PAVAN',7036585803,'CONTACT111','CHAT221','PROFILE331','STATUS441','BLOCK551','BROAD661');
INSERT INTO USER1 VALUES(2,'DATTA SAI',9133074575,'CONTACT112','CHAT222','PROFILE332','STATUS442','BLOCK552','BROAD662');
INSERT INTO USER1 VALUES(3,'RANJAN',7259308006,'CONTACT113','CHAT223','PROFILE333','STATUS443','BLOCK553','BROAD663');
INSERT INTO USER1 VALUES(4,'PRANATHI',9036248087,'CONTACT114','CHAT224','PROFILE334','STATUS444','BLOCK554','BROAD664');
INSERT INTO USER1 VALUES(5,'ASISH KUMAR',7809753461,'CONTACT115','CHAT225','PROFILE335','STATUS445','BLOCK555','BROAD665');
INSERT INTO USER1 VALUES(6,'RAGHU',8031580870,'CONTACT116','CHAT226','PROFILE336','STATUS446','BLOCK556','BROAD666');
INSERT INTO USER1 VALUES(7,'RAMAN',7736281005,'CONTACT117','CHAT227','PROFILE337','STATUS447','BLOCK557','BROAD667');


CREATE TABLE CONTACT1
(
	CONTACT_ID VARCHAR(30) PRIMARY KEY,
	NAME VARCHAR(30),
	PHONE_NO BIGINT,
	CHAT_ID VARCHAR(30),
	BLOCK_ID VARCHAR(30)
);

SELECT * FROM CONTACT1;

INSERT INTO CONTACT1 VALUES('CONTACT111','SAI PAVAN',7036585803,'CHAT221','BLOCK551');
INSERT INTO CONTACT1 VALUES('CONTACT112','DATTA SAI',9133074575,'CHAT222','BLOCK552');
INSERT INTO CONTACT1 VALUES('CONTACT113','RANJAN',7259308006,'CHAT223','BLOCK553');
INSERT INTO CONTACT1 VALUES('CONTACT114','PRANATHI',9036248087,'CHAT224','BLOCK554');
INSERT INTO CONTACT1 VALUES('CONTACT115','ASISH KUMAR',7809753461,'CHAT225','BLOCK555');
INSERT INTO CONTACT1 VALUES('CONTACT116','RAGHU',8031580870,'CHAT226','BLOCK556');
INSERT INTO CONTACT1 VALUES('CONTACT117','RAMAN',7736281005,'CHAT227','BLOCK557');

CREATE TABLE CHATS
(
  CHAT_ID VARCHAR(30) PRIMARY KEY,
  NAME VARCHAR(30),
  PHONE_NO BIGINT,
  TIME INT,
  MESSAGE VARCHAR(50),
  DATE DATE,
  BLOCK_ID VARCHAR(30),
  ONLINE VARCHAR(10)
);


SELECT * FROM CHATS;

INSERT INTO CHATS VALUES('CHAT221','SAI PAVAN',7036585803,1,'HELOO THERE','2021-05-09','BLOCK551','YES');
INSERT INTO CHATS VALUES('CHAT222','DATTA SAI',9133074575,2,'GOOD MORNING','2021-05-10','BLOCK552','NO');
INSERT INTO CHATS VALUES('CHAT223','RANJAN',7259308006,3,'GOOD NIGHT','2021-05-11','BLOCK553','YES');
INSERT INTO CHATS VALUES('CHAT224','PRANATHI',9036248087,4,'GOOD EVENING','2021-05-09','BLOCK554','NO');
INSERT INTO CHATS VALUES('CHAT225','ASISH KUMAR',7809753461,5,'GOOD AFTERNOON','2021-05-06','BLOCK555','YES');
INSERT INTO CHATS VALUES('CHAT226','RAGHU',8031580870,6,'JOIN  THE MEETING','2021-05-05','BLOCK556','NO');
INSERT INTO CHATS VALUES('CHAT227','RAMAN',7736281005,7,'EXIT FROM THE MEETING','2021-05-01','BLOCK557','YES');


CREATE TABLE STATUS1
(
 STATUS_ID VARCHAR(30) PRIMARY KEY,
 PROFILE_DP VARCHAR(30),
 TIME  INT,
 DATE  DATE,
 NAME  VARCHAR(30),
 CHAT_ID VARCHAR(30)


);

SELECT * FROM STATUS1;

 INSERT INTO STATUS1 VALUES('STATUS441','SAI PAVAN DP',1,'2021-05-09','SAI PAVAN','CHAT221');
 INSERT INTO STATUS1 VALUES('STATUS442','DATTA SAI  DP',2,'2021-05-10','DATTA SAI','CHAT222');
 INSERT INTO STATUS1 VALUES('STATUS443','RANJAN  DP',3,'2021-05-11','RANJAN','CHAT223');
 INSERT INTO STATUS1 VALUES('STATUS444','PRANATHI  DP',4,'2021-05-09','PRANATHI','CHAT224');
 INSERT INTO STATUS1 VALUES('STATUS445','ASISH KUMAR  DP',5,'2021-06-08','ASISH KUMAR','CHAT225');
 INSERT INTO STATUS1 VALUES('STATUS446','RAGHU DP',6,'2021-05-06','RAGHU','CHAT226');
 INSERT INTO STATUS1 VALUES('STATUS447','RAMAN  DP',7,'2021-05-01','RAMAN','CHAT227');


CREATE TABLE BROADCAST
(
              BROADCAST_ID VARCHAR(30) PRIMARY KEY,
              CHAT_ID VARCHAR(30),
              CONTACT_ID VARCHAR(30),
              BR_MESSAGE VARCHAR(50)	
);

SELECT * FROM BROADCAST;

INSERT INTO BROADCAST VALUES('BROAD661','CHAT221','CONTACT111','HI EVERYONE');
INSERT INTO BROADCAST VALUES('BROAD662','CHAT222','CONTACT112','HI EVERYONE');
INSERT INTO BROADCAST VALUES('BROAD663','CHAT223','CONTACT113','HI EVERYONE');
INSERT INTO BROADCAST VALUES('BROAD664','CHAT224','CONTACT114','HI EVERYONE');
INSERT INTO BROADCAST VALUES('BROAD665','CHAT225','CONTACT115','HI EVERYONE');
INSERT INTO BROADCAST VALUES('BROAD666','CHAT226','CONTACT116','HI EVERYONE');
INSERT INTO BROADCAST VALUES('BROAD667','CHAT227','CONTACT117','HI EVERYONE');

CREATE TABLE BLOCKLIST
(
  BLOCK_ID VARCHAR(30) PRIMARY KEY,
  NAME VARCHAR(30),
  PHONE_NO BIGINT
);  

SELECT* FROM BLOCKLIST;

INSERT INTO BLOCKLIST VALUES('BLOCK553','RANJAN',7259308006);
INSERT INTO BLOCKLIST VALUES('BLOCK554','PRANATHI',9036248087);
INSERT INTO BLOCKLIST VALUES('BLOCK556','RAGHU',7809753461);
INSERT INTO BLOCKLIST VALUES('BLOCK557','RAMAN',7736281005);

CREATE TABLE PROFILE
(
	PROFILE_ID VARCHAR(30) PRIMARY KEY,
	PROFILE_DP VARCHAR(30),
	ABOUT VARCHAR(100),
	PHONE_NO BIGINT,
	NAME VARCHAR(30)

);


SELECT * FROM PROFILE;

INSERT INTO PROFILE VALUES('PROFILE335','ASISH DP','SUCCESS COMES FROM EXPERIENCE N EXPERIENCE COMES FROM BAD EXPERIENCE',7809753461,'ASISH KUMAR');

INSERT INTO PROFILE VALUES('PROFILE332','DATTASAI DP','U CAN DO REVERSE ENGINEERING BUT U CANT DO REVERSE HACKING',9133074575,'DATTA SAI');

INSERT INTO PROFILE VALUES('PROFILE334','PRANATHI DP','ANEGUDDE GANAPATHI',9036248087,'PRANATHI');

INSERT INTO PROFILE VALUES('PROFILE336','RAGHU DP','MY ATTITUDE WILL ALWAYS BE BASED ON HOW YOU TREAT ME.',8031580870,'RAGHU');

INSERT INTO PROFILE VALUES('PROFILE337','RAMAN DP','DON’T JUDGE ME BY MY PAST, I DON’T LIVE THERE ANYMORE.',7736281005,'RAMAN');

INSERT INTO PROFILE VALUES('PROFILE333','RANJAN DP','WE CANNOT CHANGE ANYTHING UNLESS WE ACCEPT IT.',7259308006,'RANJAN');

INSERT INTO PROFILE VALUES('PROFILE331','SAI PAVAN DP','LOVE THE LIFE YOU LIVE-LIVE THE LIFE YOU LOVE',7036585803,'SAI PAVAN');



/*Queries*/

/*Pranathi Part*/

/* QUERY TO DISPLAY NAME, PROFILE DP,PHONE NO ,ABOUT AND CHAT ID OF
   THE USER FROM CHATS AND PROFILE TABLE WHOSE NAME CONTAINS LETTER N AND CHAT ID MUST BE IN DESCENDING ORDER*/

SELECT CHATS.NAME, PROFILE.PROFILE_DP, PROFILE.PHONE_NO, PROFILE.ABOUT, CHATS.CHAT_ID,CHATS.BLOCK_ID
FROM CHATS , PROFILE
WHERE CHATS.NAME=PROFILE.NAME AND CHATS.NAME LIKE '%N%'
ORDER BY CHATS.CHAT_ID DESC;


/* QUERY TO DISPLAY CONTACT_ID,NANE,PHONE NO,TIME,DATE OF THE MESSAGE AND MESSAGES 
FROM CHAT AND CONTACT TABLE BUT THE USER MUST BE IN ONLINE AND MESSAGE STARTS WITH 'G'*/

SELECT CONTACT1.CONTACT_ID, CONTACT1.NAME, CONTACT1.PHONE_NO, CHATS.TIME, CHATS.DATE,CHATS.MESSAGE,CHATS.ONLINE
FROM CONTACT1 INNER JOIN CHATS
ON CONTACT1.CHAT_ID =CHATS.CHAT_ID
WHERE ONLINE='YES' AND CHATS.MESSAGE LIKE 'G%';


/* QUERY TO DISPLAY  PROFILE_DP,STATUS_ID,CHAT_ID,MESSAGES, MESSAGE TIME AND MESSAGE
DATE OF WHO ARE IN OFFLINE USING USER AND CHATS TABLE WHERE MESSAGES CONTAINS 'O */

SELECT STATUS1.PROFILE_DP, STATUS1.STATUS_ID, CHATS.CHAT_ID, CHATS.MESSAGE, CHATS.TIME, CHATS.DATE,CHATS.ONLINE
FROM STATUS1 INNER JOIN CHATS
ON STATUS1.NAME=CHATS.NAME
WHERE CHATS.ONLINE='NO' AND CHATS.MESSAGE LIKE '%O%';


/* QUERY TO DISPLAY ABOUT,STATUS TIME,STATUS DATE, MESSAGES,CHAT DATE, CHAT TIME,WHO KEPT STATUS IN MAY MONTH AND USER MUST BE IN ONLINE */

SELECT PROFILE.ABOUT, STATUS1.TIME, CHATS.MESSAGE, CHATS.DATE, CHATS.TIME, CHATS.ONLINE
FROM PROFILE INNER JOIN STATUS1 
ON PROFILE.PROFILE_DP=STATUS1.PROFILE_DP
INNER JOIN CHATS ON STATUS1.CHAT_ID=CHATS.CHAT_ID
WHERE STATUS1.DATE BETWEEN '2021-04-30' AND '2021-06-01' AND CHATS.ONLINE='YES';


/* QUERY TO DISPLAY CHAT_ID, MESSAGES,PROFILE_DP,PROFILE_ID,BLOCK_ID, NAME ABOUT OF WHO ARE IN ONLINE USING CHATS,PROFILE AND BLOCK LIST TABLE
   WHERE NAME STARTS WITH 'R' AND ENDS WITH 'N' AND CHAT_ID RANGE FROM 222 TO 227 */

SELECT CHATS.CHAT_ID, CHATS.MESSAGE, PROFILE.PROFILE_DP, PROFILE.PROFILE_ID, BLOCKLIST.BLOCK_ID,CHATS.NAME,PROFILE.ABOUT
FROM CHATS INNER JOIN PROFILE ON CHATS.PHONE_NO=PROFILE.PHONE_NO 
INNER JOIN BLOCKLIST ON PROFILE.PHONE_NO=BLOCKLIST.PHONE_NO
WHERE ONLINE='YES' AND CHATS.NAME LIKE 'R%N' AND CHATS.CHAT_ID BETWEEN 'CHAT222' AND 'CHAT227';

/* QUERY TO DISPLAY BROADCAST_ID,CHAT_ID, BLOCK_ID,STATUS_ID
MESSAGES,PROFILE_DP,NAME, BROADCAST_MESSAGE USING BROADCAST,CHAT AND STATUS TABLE WHERE THE BROADCAST_ID RANGE FROM 663 TO 666 AND NAME CONTAINS 'A' */

SELECT BROADCAST.BROADCAST_ID, CHATS.CHAT_ID, CHATS.BLOCK_ID, STATUS1.STATUS_ID, CHATS.MESSAGE, STATUS1.PROFILE_DP
BROADCAST_MESSAGE
FROM BROADCAST INNER JOIN CHATS ON BROADCAST.CHAT_ID=CHATS.CHAT_ID 
INNER JOIN STATUS1 ON STATUS1.CHAT_ID=CHATS.CHAT_ID 
WHERE BROADCAST_ID BETWEEN 'BROAD663' AND 'BROAD666' AND CHATS.NAME LIKE '%A%';


/*Ranjan part*/

/* QUERY A DISPLAY NAME , PHONE_NO , MESSAGE , DATE  AND TIME OF THE USER FROM  STATUS1 TABLE , CHATS TABLE AND BLOCK TABLE IN WHICH NAME
SHOULD NOT CONSIST N LETTER EITHER IN FIRST OR IN LAST LETTER AND ORDERED BY STAUTS_ID*/

 
SELECT STATUS1.NAME,CHATS.PHONE_NO,CHATS.MESSAGE,STATUS1.DATE,STATUS1.TIME
FROM STATUS1 INNER JOIN  CHATS ON STATUS1.CHAT_ID  = CHATS.CHAT_ID 
INNER JOIN BLOCKLIST ON CHATS.BLOCK_ID = BLOCKLIST.BLOCK_ID
 WHERE STATUS1.NAME LIKE  ('%N%')
ORDER BY  STATUS1.STATUS_ID  ;


/* QUERY A DISPLAY NAME ,PHONE_NO ,PROFILE_DP,ABOUT,ONLINE OF  THE USER USING CHATS TABLE AND PROFILE TABLE ONLY THOSE 
WHO ARE ONLINE  */

SELECT CHATS.NAME,CHATS.PHONE_NO,PROFILE.PROFILE_DP,PROFILE.ABOUT,
CHATS.ONLINE
FROM CHATS LEFT JOIN PROFILE ON CHATS.NAME = PROFILE.NAME 
WHERE CHATS.ONLINE = 'YES'
ORDER BY CHATS.NAME;

/*QUERY TO DISPLAY THE NAME , PHONE_NO , MESSAGE ,ONLINE ,DATE 	AND TIME OF THE USER BY USING CONTACT1 ,
BLOCKLIST AND CHATS TABLE IN WHICH THE USER IS NOT BLOCKED AND USER IS IN ONLINE */

SELECT CONTACT1.NAME,CONTACT1.PHONE_NO,CHATS.MESSAGE,CHATS.ONLINE,CHATS.DATE,
CHATS.TIME
FROM  CONTACT1 LEFT JOIN BLOCKLIST ON BLOCKLIST.BLOCK_ID = CONTACT1.BLOCK_ID
INNER JOIN  CHATS ON  CONTACT1.CHAT_ID = CHATS.CHAT_ID
WHERE CONTACT1.NAME NOT IN ('RANJAN','PRANATHI','RAGHU','RAMAN') 
AND CHATS.ONLINE='YES'
ORDER BY CONTACT1.NAME;

/*QUERY A DISPLAY NAME , PHONE_NO , MESSAGE , DATE AND TIME AND ONLINE OF THE USER USING CONTACT TABLE AND CHATS TABLE  WHERE 
	THE USER SHOULD BE OFFLINE AND CHAT TIME SHOULD BE NOT IN 4 */

SELECT CHATS.NAME ,CHATS.PHONE_NO , CHATS.MESSAGE , CHATS.DATE ,CHATS.TIME,CHATS.ONLINE
FROM CONTACT1 INNER JOIN CHATS ON CONTACT1.CHAT_ID = CHATS.CHAT_ID 
WHERE CHATS.ONLINE='NO' AND CHATS.TIME NOT IN (4);

/*QUERY A DISPLAY THE USER _ID,NAME , PHONE_NO , MESSAGE , DATE AND TIME OF THE USER BY USING 
CHAT TABLE AND USER1 TABLE WHOSE CHAT TIME IS BETWEEN 2 AND 6 AND THE USER_ID SHOULD BE ARRANGED IN DESCENDING ORDER */

SELECT USER1.USER1_ID ,USER1.NAME,USER1.PHONE_NO, CHATS.MESSAGE,CHATS.TIME,CHATS.DATE
FROM USER1 INNER JOIN CHATS ON USER1.CHAT_ID = CHATS.CHAT_ID
WHERE CHATS.TIME BETWEEN 2 AND 6 
ORDER BY USER1.NAME;

/* WRITE A QUERY A DISPLAY THE NAME , PHONE_NO , BR_MESSAGE OF 
THE USER USING CONTACT TABLE AND BROADCAST TABLE IN WHICH NAME CONSIST OF TWO A’s AND ORDERED BY PHONE_NO */

SELECT CONTACT1.NAME, CONTACT1.PHONE_NO, BROADCAST.BR_MESSAGE
FROM CONTACT1 INNER JOIN BROADCAST ON CONTACT1.CONTACT_ID = BROADCAST.CONTACT_ID
WHERE CONTACT1.NAME LIKE ('%A%A%')
ORDER BY CONTACT1.PHONE_NO;


/* Asish part*/


/*QUERY TO DISPLAY CONTACT NAME,PHONE NUMBER,CHAT_ID,BROADCAST_ID,
CONTACT_ID FROM CONTACT TABLE AND JOIN WITH BROADCAST TABLE  AND  FIND OUT WHOSE NAME ENDS WITH ‘ I ‘ AND ORDER WISE ACSENDNG TO DESCENDING BY THEIR NAME */

SELECT CONTACT1.NAME,CONTACT1.PHONE_NO,CONTACT1.CHAT_ID,
BROADCAST.BROADCAST_ID,BROADCAST.CONTACT_ID
FROM CONTACT1 
INNER JOIN BROADCAST  ON CONTACT1.CONTACT_ID = 
BROADCAST.CONTACT_ID
WHERE NAME LIKE '%I'
ORDER BY CONTACT1.NAME;

/* QUERY TO DISPLAY CONTACT NAME,CONTACT PHONE NO,BROADCAST ID,
BROADCAST MESSAGE FROM JOINING THE  TABLES AND FIND OUT IN TABLE THOSE LAST 4 NAMES AND NUMBERS FROM BROADCAST TABLE */

SELECT CONTACT1.NAME,CONTACT1.PHONE_NO,BROADCAST.CONTACT_ID,BROADCAST.BR_MESSAGE
FROM CONTACT1
INNER JOIN BROADCAST ON  BROADCAST.CONTACT_ID = CONTACT1.CONTACT_ID
WHERE 
BROADCAST.CONTACT_ID = CONTACT1.CONTACT_ID AND CONTACT1.CONTACT_ID IN('CONTACT114','CONTACT115','CONTACT116','CONTACT117');

/* QUERY TO DISPLAY CONTACT NAME , CONTACT PHONE NO AND FIND OUT BLOCKED LIST FROM TABLE USIN ORDER BY NAMES */

SELECT CONTACT1.NAME,CONTACT1.PHONE_NO
FROM CONTACT1 
INNER JOIN BLOCKLIST ON CONTACT1.BLOCK_ID = BLOCKLIST.BLOCK_ID
ORDER BY CONTACT1.NAME DESC;


/* QUERY TO DISPLAY NAME,PHONE_NO,CHATS.MEAGE,PROFILE_ID,BLOCK_ID ATRIBUTE AND JOIN 4 TABLES
(USER TABLE,CONTACT TABLE,CHAT TABLE,BLOCK TABLE) FOR GETTING THOSE DATA */

SELECT CONTACT1.NAME,CONTACT1.PHONE_NO,CHATS.MESSAGE,USER1.PROFILE_ID,
BLOCKLIST.BLOCK_ID
FROM CONTACT1 JOIN CHATS ON CONTACT1.CHAT_ID=CHATS.CHAT_ID
JOIN BLOCKLIST ON CHATS.BLOCK_ID=BLOCKLIST.BLOCK_ID
JOIN USER1 ON USER1.BLOCK_ID=BLOCKLIST.BLOCK_ID;

/* QUERY TO DISPLAY PHONE_NO,PROFILE_DP,NAME,CHAT_ID,TIME,ONLINE
OR OFFLINE ,STATUS_ID  USING JOINS ALL TABLE AND FIND OUT  WHOSE PROFILE_DP IS MATCHED */

SELECT PROFILE.PHONE_NO,PROFILE.PROFILE_DP,PROFILE.NAME,
CHATS.CHAT_ID,CHATS.TIME,CHATS.ONLINE,STATUS1.STATUS_ID
FROM PROFILE JOIN STATUS1 ON PROFILE.PROFILE_DP=STATUS1.PROFILE_DP
JOIN CHATS ON STATUS1.CHAT_ID=CHATS.CHAT_ID;
 

/* Sai pavan part */

/* QUERY TO GET PARTICULAR STATUS DATA USING LIKE OPERATOR
AND JOINS(WHEN WE KEPT THAT STATUS AND DATA NAME LIKE 'S%N'). IT DISPLAYS STATUS_ID,NAME,TIME AND DATE */

SELECT STATUS1.STATUS_ID,STATUS1.NAME,STATUS1.TIME,STATUS1.DATE 
FROM STATUS1 INNER JOIN PROFILE ON STATUS1.PROFILE_DP = PROFILE.PROFILE_DP 
WHERE STATUS1.NAME LIKE 'S%N';

/* QUERY TO DISPLAY THE BLOCK-LIST PERSON LAST MESSAGES WITH DATE AND TIME.
USING JOINS WITH  ORDER BY IN ASCENDING ORDER.IT DISPLAYS CHAT_ID,NAME,PHONE_NO,MESSAGE,DATE,TIME AND BLOCK_ID */ 

SELECT TOP 1 CHATS.CHAT_ID,CHATS.NAME,CHATS.PHONE_NO,CHATS.MESSAGE,
CHATS.DATE,CHATS.TIME,CHATS.BLOCK_ID 
FROM CHATS INNER JOIN BLOCKLIST ON CHATS.BLOCK_ID = BLOCKLIST.BLOCK_ID 
ORDER BY  CHATS.DATE DESC;

/* WRITE A QUERY TO GET ALL USERS IN HIS PROFILE THAT WILL SHOW.
USING INNER JOINS AND ORDER BY IN ASC. IT DISPLAYS USER_ID,NAME,PHONE_NO AND ABOUT */ 

SELECT USER1.USER1_ID,USER1.NAME,USER1.PHONE_NO,ABOUT
FROM USER1 INNER JOIN PROFILE ON USER1.PROFILE_ID = PROFILE.PROFILE_ID ORDER BY USER1.NAME;

/* WRITE A QUERY TO GET PARTICULAR USER STATUS DATA USE OF PARTICULAR
DATE AND TIME.USING JOINS WITH AND CONDITION. IT DISPLAYS STATUS_ID,NAME,TIME AND DATE */ 

SELECT STATUS1.STATUS_ID,STATUS1.NAME,STATUS1.TIME,STATUS1.DATE
FROM USER1 INNER JOIN STATUS1 ON USER1.STATUS_ID = STATUS1.STATUS_ID 
where STATUS1.DATE='2021-05-09' AND STATUS1.TIME='1';

/* WRITE A QUERY TO GET WHOEVER IN CHATS AND WHOEVER IN BLOCK.IT DISPLAYS COMMON MEMBERS FROM BOTH CHATS TABLE AND BLOCK TABLE.FINALLY 
WE GET WHOEVER CHATTED PEOPLE IN BLOCK TABLE. USING JOINS AND DESC KEYWORD.IT DISPLAYS CHAT_ID,NAME,PHONE_NO,MESSAGE,DATE,TIME AND BLOCK_ID */ 

 
SELECT CHATS.CHAT_ID,CHATS.NAME,CHATS.PHONE_NO,CHATS.MESSAGE,
CHATS.DATE,CHATS.TIME,CHATS.BLOCK_ID 
FROM CHATS INNER JOIN BLOCKLIST ON CHATS.BLOCK_ID = BLOCKLIST.BLOCK_ID 
ORDER BY CHATS.BLOCK_ID DESC;


/* QUERY TO GET WHOEVER SENT MESSAGES ON A PARTICULAR DATES .
USING JOINS AND BETWEEN OPERATOR .IT DISPLAYS CHAT_ID,NAME,PHONE_NO,MESSAGE,DATE AND TIME */ 

SELECT CHATS.CHAT_ID,CHATS.NAME,CHATS.PHONE_NO,CHATS.MESSAGE,
CHATS.DATE,CHATS.TIME
FROM USER1 INNER JOIN CHATS  ON CHATS.CHAT_ID = USER1.CHAT_ID 
WHERE CHATS.DATE BETWEEN '2021-05-06' AND '2021-05-09';


/*Dattasai Part*/


/* Query to display   top 3 recently contacted person */

select top 3 u.name, u.phone_no, concat(c.time,' ',c.date) as recent from USER1 u, CHATS c
where u.CHAT_ID=c.CHAT_ID order by recent;

/* QUERY TO DISPLAY   NAME, PHONE NUMBER OF BLOCK LIST PERSONS WHOSE NAME ENDS WITH N */

SELECT C.NAME, C.PHONE_NO FROM BLOCKLIST B, CONTACT1 C
WHERE C.BLOCK_ID=B.BLOCK_ID AND C.NAME LIKE '%N';

/* QUERY TO DISPLAY THE NAME, ABOUT NEW, STATUS BROADCAST, STATUS TIME BY USING JOIN */

SELECT S.PROFILE_DP AS "NAME",P.ABOUT AS "ABOUT NEW", U.BROADCAST_ID AS "EVERYONE", S.TIME AS "STATUS TIME"
FROM STATUS1 S,PROFILE P,USER1 U FULL OUTER JOIN CHATS C ON C.PHONE_NO=U.PHONE_NO 
WHERE C.CHAT_ID=S.CHAT_ID AND P.PHONE_NO=U.PHONE_NO;

/* QUERY TO DISPLAY USERNAME, PROFILE_DP, MESSAGE WHOSE PHONE NUMBER STARTS WITH 7 AND WHOSE STATUS IS ONLINE */

select U.NAME, P.PROFILE_DP,C.PHONE_NO, C.MESSAGE
FROM USER1 U, PROFILE P, CHATS C
WHERE U.PHONE_NO=P.PHONE_NO AND C.PHONE_NO=P.PHONE_NO AND C.ONLINE='YES' AND  C.PHONE_NO LIKE '7%';


/* QUERY TO DISPLAY NAME, PROFILE DP,PHONE NO ,ABOUT AND
CHAT ID OF THE USER FROM CHATS AND PROFILE TABLE WHOSE NAME CONTAINS LETTER I AND CHAT ID */

SELECT CHATS.NAME, PROFILE.PROFILE_DP, PROFILE.PHONE_NO, PROFILE.ABOUT, CHATS.CHAT_ID,CHATS.BLOCK_ID
FROM CHATS , PROFILE
WHERE CHATS.NAME=PROFILE.NAME AND CHATS.NAME LIKE '%I%'
ORDER BY CHATS.CHAT_ID ;

















 

 
 









  